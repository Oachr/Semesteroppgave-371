function updateWordSearch(){searchWord=$("#searchWord").val().toLowerCase(),politicianWordFrequency=[],commentWordFrequency=[],$(".chart").empty();for(var e=0;e<politiker.length;e++)fillArray(politicianWordFrequency,politiker,e),fillArray(commentWordFrequency,politikerKommentarfelt,e);$(".chart").append("<h2>Du søkte på: <span style='color:red'>"+searchWord+"</span></h2>")}function fillArray(e,n,a){$.ajax({url:"data/Term_frequencies/"+n[a]+"-termFrequency.json",dataType:"text",success:function(t){var r=$.parseJSON(t);$.each(r,function(t,r){r._row==searchWord&&e.push({politician:n[a].split("-")[0],freq:r.freq,percent:r.Percent})})}})}function drawBar(e){function n(e){return e.freq=+e.freq,e}var a={top:20,right:20,bottom:30,left:40},t=1200-a.left-a.right,r=500-a.top-a.bottom,s=d3.scale.ordinal().rangeRoundBands([0,t],.1),o=d3.scale.linear().range([r,0]),i=d3.svg.axis().scale(s).orient("bottom"),l=d3.svg.axis().scale(o).orient("left").ticks(5,""),d=d3.select(".chart").append("svg").attr("width",t+a.left+a.right).attr("height",r+a.top+a.bottom).append("g").attr("transform","translate("+a.left+","+a.top+")");s.domain(e.map(function(e){return e.politician})),o.domain([0,d3.max(e,function(e){return e.freq})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(i),d.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Antall"),d.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",function(e){return s(e.politician)}).attr("width",s.rangeBand()).attr("y",function(e){return o(e.freq)}).attr("height",function(e){return r-o(e.freq)})}function drawBarPercent(e){function n(e){return e.percent=+e.percent,e}var a={top:20,right:20,bottom:30,left:40},t=1200-a.left-a.right,r=500-a.top-a.bottom,s=d3.scale.ordinal().rangeRoundBands([0,t],.1),o=d3.scale.linear().range([r,0]),i=d3.svg.axis().scale(s).orient("bottom"),l=d3.svg.axis().scale(o).orient("left").ticks(10,"%"),d=d3.select(".chart").append("svg").attr("width",t+a.left+a.right).attr("height",r+a.top+a.bottom).append("g").attr("transform","translate("+a.left+","+a.top+")");s.domain(e.map(function(e){return e.politician})),o.domain([0,d3.max(e,function(e){return e.percent})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(i),d.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Prosent"),d.selectAll(".bar").data(e).enter().append("rect").attr("class","bar").attr("x",function(e){return s(e.politician)}).attr("width",s.rangeBand()).attr("y",function(e){return o(e.percent)}).attr("height",function(e){return r-o(e.percent)})}function readTextFile(e,n){var a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",e,!0),a.onreadystatechange=function(){4===a.readyState&&"200"==a.status&&n(a.responseText)},a.send(null)}function makePie(e,n,a,t){var r=new d3pie(t,{header:{title:{text:e,fontSize:24,font:"open sans"},subtitle:{text:n,color:"#999999",fontSize:12,font:"open sans"},titleSubtitlePadding:9},footer:{color:"#999999",fontSize:10,font:"open sans",location:"bottom-left"},size:{canvasWidth:550,pieOuterRadius:"59%"},data:{sortOrder:"value-asc",content:[{label:"Erna Solberg",value:a[0].verdi[0],color:"#7e6838"},{label:"Siv Jensen",value:a[1].verdi[0],color:"#384a7e"},{label:"Jonas Gahr Støre",value:a[2].verdi[0],color:"#4a7e38"},{label:"Knut Arild Hareide",value:a[3].verdi[0],color:"#5f7e38"},{label:"Audun Lysbakken",value:a[4].verdi[0],color:"#45387e"},{label:"Trin Skei Grande",value:a[5].verdi[0],color:"#387e42"},{label:"Per Sandberg",value:a[6].verdi[0],color:"#385c7e"},{label:"Rasmus Hansson",value:a[7].verdi[0],color:"#387e5c"},{label:"Jan T Sanner",value:a[8].verdi[0],color:"#7e5038"},{label:"Torbjørn Røe Isaksen",value:a[9].verdi[0],color:"#767e38"},{label:"Dagrun Eriksen",value:a[10].verdi[0],color:"#387e73"},{label:"Geir Sannes Pedersen",value:a[11].verdi[0],color:"#53387e"},{label:"Bård Vegar Solhjell",value:a[12].verdi[0],color:"#384a7e"},{label:"Une Bastholm",value:a[13].verdi[0],color:"#386d7e"},{label:"Hanna Marcussen",value:a[14].verdi[0],color:"#7e3838"}]},labels:{outer:{format:"label-value1",pieDistance:32},inner:{format:"none"},mainLabel:{fontSize:11},percentage:{color:"#ffffff",decimalPlaces:0},value:{color:"#adadad",fontSize:11},lines:{enabled:!0},truncation:{enabled:!0}},tooltips:{enabled:!0,type:"placeholder",string:"{label}: {value}"},effects:{load:{speed:750},pullOutSegmentOnClick:{effect:"linear",speed:400,size:8}},misc:{pieCenterOffset:{x:-25}}})}function makeChord(){function e(e){var n=(e.endAngle-e.startAngle)/e.value;return d3.range(0,e.value,5).map(function(a,t){return{angle:a*n+e.startAngle,label:a}})}function n(e){return function(n,a){l.selectAll(".chord path").filter(function(e){return e.source.index!=a&&e.target.index!=a}).transition().style("opacity",e)}}var a=d3.layout.chord().padding(.06).sortSubgroups(d3.descending).matrix(matrix),t=550,r=500,s=.41*Math.min(t,r),o=1.1*s,i=d3.scale.ordinal().domain(d3.range(15)).range(chordColors),l=d3.select("#chordGraph").append("svg").attr("width",t).attr("height",r).append("g").attr("transform","translate("+t/2+","+r/2+")");l.append("g").selectAll("path").data(a.groups).enter().append("path").style("fill",function(e){return i(e.index)}).style("stroke",function(e){return i(e.index)}).attr("d",d3.svg.arc().innerRadius(s).outerRadius(o)).on("mouseover",n(.1)).on("mouseout",n(1));var d=l.append("g").selectAll("g").data(a.groups).enter().append("g").selectAll("g").data(e).enter().append("g").attr("transform",function(e){return"rotate("+(180*e.angle/Math.PI-90)+")translate("+o+",0)"});d.append("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#000"),d.append("text").attr("x",8).attr("dy",".35em").attr("transform",function(e){return e.angle>Math.PI?"rotate(180)translate(-16)":null}).style("text-anchor",function(e){return e.angle>Math.PI?"end":null}).text(function(e){return e.label}),l.append("g").attr("class","chord").selectAll("path").data(a.chords).enter().append("path").attr("d",d3.svg.chord().radius(s)).style("fill",function(e){return i(e.target.index)}).style("opacity",1)}function fillSentimentScores(e,n,a){$.ajax({url:"data/Sentiment_scores/"+n[a]+"-sentimentScores.json",dataType:"text",success:function(e){var t=$.parseJSON(e),r=0,s=0,o=0;$.each(t,function(e,n){n.V1>0?r++:n.V1<0?s++:o++}),sentimentScores.push({name:n[a],value:r,value2:s,value3:o})}})}function makeSentimentChart(e,n){function a(e){return e.value=+e.value,e}data=e;var t={top:30,right:10,bottom:10,left:10},r=500-t.left-t.right,s=500-t.top-t.bottom,o=d3.scale.linear().range([0,r]),i=d3.scale.ordinal().rangeRoundBands([0,s],.2),l=d3.svg.axis().scale(o).orient("top"),d=d3.select(n).append("svg").attr("width",r+t.left+t.right).attr("height",s+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");o.domain([-250,250]),i.domain(data.map(function(e){return e.name})),d.selectAll(".bar").data(data).enter().append("rect").attr("class","bar").attr("x",function(e){return o(Math.min(0,e.value))}).attr("y",function(e){return i(e.name)}).attr("width",function(e){return Math.abs(o(e.value)-o(0))}).attr("height",i.rangeBand()),d.selectAll(".bar2").data(data).enter().append("rect").attr("class","bar2").attr("x",function(e){return o(Math.min(0,-e.value2))}).attr("y",function(e){return i(e.name)}).attr("width",function(e){return Math.abs(o(-e.value2)-o(0))}).attr("height",i.rangeBand()),d.append("g").attr("class","x axis").call(l),d.append("g").attr("class","y axis").append("line").attr("x1",o(0)).attr("x2",o(0)).attr("y2",s)}var searchWord="",politicianWordFrequency=[],commentWordFrequency=[],politicianWordPercent=[],commentWordPercent=[],politiker=["audunlysbakken","bardvegar","dagruneriksen","ernasolberg","geirsp","hanna.e.marcussen","JanTSanner","jonasgahrstore","Knut.Arild.Hareide","Per.Sandberg.FrP","rasmusjmhansson","Siv.Jensen.FrP","torbjornroeisaksen","trinesg","UneBastholm"],politikerFulltNavn=["Audun Lysbakken","Bård Vegar Solhjell","Dagrun Eriksen","Erna Solberg","Geir Sannes Pedersen","Hanna Marcussen","Jan T Sanner","Jonas Gahr Støre","Knut Arild Hareide","Per Sandberg","Rasmus Hansson","Siv Jensen","Torbjørn Røe Isaksen","Trine Skei Grande","Une Bastholm"],politikerKommentarfelt=["audunlysbakken-comments","bardvegar-comments","dagruneriksen-comments","ernasolberg-comments","geirsp-comments","hanna.e.marcussen-comments","JanTSanner-comments","jonasgahrstore-comments","Knut.Arild.Hareide-comments","Per.Sandberg.FrP-comments","rasmusjmhansson-comments","Siv.Jensen.FrP-comments","torbjornroeisaksen-comments","trinesg-comments","UneBastholm-comments"];$("#searchButton").click(function(){updateWordSearch()}),$(document).ajaxStop(function(){politicianWordFrequency.length>0&&($(".chart").append("<h3>Antall ganger ordet er nevnt i post</h3>"),drawBar(politicianWordFrequency),$(".chart").append("<h3>Prosentvis ordet er nevnt i post</h3>"),drawBarPercent(politicianWordFrequency)),commentWordFrequency.length>0&&($(".chart").append("<h3>Antall ganger ordet er nevnt i kommentar</h3>"),drawBar(commentWordFrequency),$(".chart").append("<h3>Prosentvis ordet er nevnt i kommentar</h3>"),drawBarPercent(commentWordFrequency))});var statsArray=[];readTextFile("data/Politician_info/AggregatedPoliticianInfo.json",function(e){statsArray=JSON.parse(e);for(var n=[],a=[],t=[],r=[],s=0;s<statsArray.length;s++)"ernasolberg"==statsArray[s][0].from?($("#erna-info").append("<h3>Post med flest likes</h3>"),$("#erna-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#erna-info").append("<h3>Post med flest delinger</h3>"),$("#erna-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"Siv.Jensen.FrP"==statsArray[s][0].from?($("#siv-info").append("<h3>Post med flest likes</h3>"),$("#siv-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#siv-info").append("<h3>Post med flest delinger</h3>"),$("#siv-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"jonasgahrstore"==statsArray[s][0].from?($("#jonas-info").append("<h3>Post med flest likes</h3>"),$("#jonas-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#jonas-info").append("<h3>Post med flest delinger</h3>"),$("#jonas-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"Knut.Arild.Hareide"==statsArray[s][0].from?($("#knut-info").append("<h3>Post med flest likes</h3>"),$("#knut-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#knut-info").append("<h3>Post med flest delinger</h3>"),$("#knut-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"audunlysbakken"==statsArray[s][0].from?($("#audun-info").append("<h3>Post med flest likes</h3>"),$("#audun-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#audun-info").append("<h3>Post med flest delinger</h3>"),$("#audun-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"trinesg"==statsArray[s][0].from?($("#trine-info").append("<h3>Post med flest likes</h3>"),$("#trine-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#trine-info").append("<h3>Post med flest delinger</h3>"),$("#trine-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"Per.Sandberg.FrP"==statsArray[s][0].from?($("#per-info").append("<h3>Post med flest likes</h3>"),$("#per-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#per-info").append("<h3>Post med flest delinger</h3>"),$("#per-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"rasmusjmhansson"==statsArray[s][0].from?($("#rasmus-info").append("<h3>Post med flest likes</h3>"),$("#rasmus-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#rasmus-info").append("<h3>Post med flest delinger</h3>"),$("#rasmus-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"JanTSanner"==statsArray[s][0].from?($("#jan-info").append("<h3>Post med flest likes</h3>"),$("#jan-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#jan-info").append("<h3>Post med flest delinger</h3>"),$("#jan-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"torbjornroeisaksen"==statsArray[s][0].from?($("#torbjorn-info").append("<h3>Post med flest likes</h3>"),$("#torbjorn-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#torbjorn-info").append("<h3>Post med flest delinger</h3>"),$("#torbjorn-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"dagruneriksen"==statsArray[s][0].from?($("#dagrun-info").append("<h3>Post med flest likes</h3>"),$("#dagrun-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#dagrun-info").append("<h3>Post med flest delinger</h3>"),$("#dagrun-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"geirsp"==statsArray[s][0].from?($("#geir-info").append("<h3>Post med flest likes</h3>"),$("#geir-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#geir-info").append("<h3>Post med flest delinger</h3>"),$("#geir-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"bardvegar"==statsArray[s][0].from?($("#bard-info").append("<h3>Post med flest likes</h3>"),$("#bard-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#bard-info").append("<h3>Post med flest delinger</h3>"),$("#bard-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"UneBastholm"==statsArray[s][0].from?($("#une-info").append("<h3>Post med flest likes</h3>"),$("#une-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#une-info").append("<h3>Post med flest delinger</h3>"),$("#une-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")):"hanna.e.marcussen"==statsArray[s][0].from&&($("#hanna-info").append("<h3>Post med flest likes</h3>"),$("#hanna-info").append("<p>"+statsArray[s][0].mostLikedMessage+"</p>"),$("#hanna-info").append("<h3>Post med flest delinger</h3>"),$("#hanna-info").append("<p>"+statsArray[s][0].mostSharedMessage+"</p>")),n.push({verdi:statsArray[s][0].meanLikes}),a.push({verdi:statsArray[s][0].meanComments}),t.push({verdi:statsArray[s][0].meanShares}),r.push({verdi:statsArray[s][0].meanWordCount});var o="Gjennomsnittlig antall likes",i="Viser hvor mange likes de forskjellige politikerne har fått";makePie(o,i,n,"pieChart");var l="Gjennomsnittlig antall kommentarer",d="Viser hvor mange kommentarer de forskjellige politikerne har fått";makePie(l,d,a,"pieChart2");var p="Gjennomsnittlig antall delinger",m="Viser hvor mange delinger de forskjellige politikerne har fått";makePie(p,m,t,"pieChart3");var u="Gjennomsnittlig antall ord",c="Viser hvor mange ord som blir brukt i postene, vanligste ord er fjernet";makePie(u,c,r,"pieChart4")});var matrix=[[0,3,2,0,0,0,3,1,1,0,2,2,0,0,0],[2,0,5,1,0,0,0,1,3,0,0,0,0,0,0],[6,2,0,0,0,0,3,1,2,0,1,0,0,0,0],[0,0,0,1,0,1,0,0,0,0,0,0,0,0,0],[5,3,3,0,0,0,4,1,7,0,0,0,0,4,0],[2,6,0,0,0,4,6,2,5,2,0,0,0,1,0],[5,0,0,0,0,0,0,1,1,0,2,0,0,0,0],[1,0,0,2,0,0,2,1,1,0,0,0,0,0,0],[1,4,4,0,2,0,0,0,12,0,0,0,3,0,0],[1,0,3,2,1,0,1,2,0,0,0,1,0,0,1],[1,0,0,0,0,1,2,1,1,0,1,0,0,1,0],[0,2,0,1,0,0,0,0,0,9,0,1,0,0,0],[0,1,0,0,0,0,1,4,1,0,0,0,26,0,0],[0,0,0,1,2,0,0,0,1,0,1,0,0,0,1],[0,0,0,0,0,0,0,0,0,3,0,0,0,1,0]],chordPoliticians=["Erna Solberg","Siv Jensen","Jonas Gahr Støre","Trine Skei Grande","Audun Lysbakken","Geir Sannes Pedersen","Jan T Sanner","Knut Arild Hariede","Per Sandberg","Rasmus Hansson","Torbjørn Røe Isaksen","Une Bastholm","Dagrun Eriksen","Bård Vegar Solhjell","Hanna Marcussen"],chordColors=["#000000","#FFDD89","#957244","#F26223","#727272","#f1595f","#79c36a","#599ad3","#f9a65a","#9e66ab","#cd7058","#d77fb3","#03C03C","#779ECB","#C23B22"];$(".pol-names").append("<p>");for(var i=0;i<chordPoliticians.length;i++)$(".pol-names").append("<span style=' color: "+chordColors[i]+"'>"+chordPoliticians[i]+" </span>");$(".pol-names").append("</p>"),makeChord();for(var sentimentScores=[],i=0;i<politiker.length;i++)fillSentimentScores(sentimentScores,politiker,i);$(document).ajaxStop(function(){makeSentimentChart(sentimentScores,"#sentimentGraph");for(var e=0;e<sentimentScores.length;e++){var n=[];"ernasolberg"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#erna-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#erna-info")):"audunlysbakken"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#audun-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#audun-info")):"Siv.Jensen.FrP"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#siv-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#siv-info")):"bardvegar"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#bard-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#bard-info")):"dagruneriksen"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#dagrun-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#dagrun-info")):"geirsp"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#geir-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#geir-info")):"hanna.e.marcussen"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#hanna-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#hanna-info")):"JanTSanner"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#jan-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#jan-info")):"jonasgahrstore"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#jonas-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#jonas-info")):"Knut.Arild.Hareide"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#knut-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#knut-info")):"Per.Sandberg.FrP"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#per-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#per-info")):"rasmusjmhansson"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#rasmus-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#rasmus-info")):"torbjornroeisaksen"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#torbjorn-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#torbjorn-info")):"trinesg"==sentimentScores[e].name?(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#trine-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#trine-info")):"UneBastholm"==sentimentScores[e].name&&(n.push({name:sentimentScores[e].name,value:sentimentScores[e].value,value2:sentimentScores[e].value2}),$("#une-info").append("<h3>Sentiment analyse</h3>"),makeSentimentChart(n,"#une-info"))}for(var e=0;e<politikerFulltNavn.length;e++)$("#sentimentNames").append(politikerFulltNavn[e]+", ")});